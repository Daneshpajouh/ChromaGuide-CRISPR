% ======================================================================
% MASTER THESIS DOCUMENT - CORRECTED VERSION
% CRISPRO-MAMBA-X: Revolutionary AI/ML Gene Editing Platform
% Simon Fraser University PhD Dissertation
% ======================================================================

\documentclass[12pt]{sfuthesis}

% ======================================================================
% PACKAGES - ORGANIZED BY CATEGORY
% ======================================================================

% MATH PACKAGES
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{amsfonts}
\usepackage{amsthm}  % ADDED: For theorem environments
\usepackage{mathbbol}
\usepackage{mathtools}
\usepackage{xfrac}

% ALGORITHMS AND CODE
\usepackage{algorithm}
\usepackage{algpseudocode}
\usepackage{algorithmicx}
\usepackage{listings}
% \usepackage{adjustbox} % Missing on system
% \usepackage[version=4]{mhchem} % Missing on system
\usepackage{microtype}

\lstset{
  breaklines=true,
  breakatwhitespace=true,
  basicstyle=\small\ttfamily,
  columns=flexible,
  keepspaces=true,
  showstringspaces=false
}

% GRAPHICS AND FIGURES
\usepackage{xcolor}
\usepackage{graphicx}
% REMOVED: \usepackage{subfigure}  % CONFLICTS WITH TOCLOFT
\usepackage{float}
\usepackage{tikz}
\usetikzlibrary{positioning, shapes.geometric, calc, decorations.pathmorphing, patterns}
\usepackage{pgfplots}
\pgfplotsset{compat=1.18}
% \usepackage{caption}
% \usepackage{subcaption}  % Better alternative to subfigure

% TABLES
\usepackage{multirow}
\usepackage{array}
\usepackage{booktabs}
\usepackage{threeparttable}
\usepackage{longtable}
\usepackage{tabu}

% BIBLIOGRAPHY AND REFERENCES
\usepackage[numbers,sort&compress]{natbib}
\usepackage{hyperref}
\usepackage{url}

% DEFINITIONS FOR MISSING CLASS COMMANDS
\providecommand{\supervisor}[2]{}
\providecommand{\externalexaminer}[2]{}
\providecommand{\approval}{}
\providecommand{\chair}[2]{}
\providecommand{\committee}[1]{}
\newenvironment{acknowledgments}{\chapter*{Acknowledgments}}{}

% FORMATTING
\usepackage{geometry}
\usepackage{setspace}
\usepackage{tocbibind}
\usepackage{fancyhdr}
\usepackage{lastpage}
\usepackage{lineno}
\usepackage{color}
\usepackage{pifont}  % ADDED: For \ding symbols

% ======================================================================
% THEOREM ENVIRONMENTS - ADDED
% ======================================================================

\theoremstyle{definition}
\newtheorem{definition}{Definition}[chapter]
\newtheorem{theorem}{Theorem}[chapter]
\newtheorem{lemma}{Lemma}[chapter]
\newtheorem{proposition}{Proposition}[chapter]
\newtheorem{corollary}{Corollary}[chapter]

\theoremstyle{remark}
\newtheorem{example}{Example}[chapter]
\newtheorem{remark}{Remark}[chapter]

% ======================================================================
% DOCUMENT SETUP
% ======================================================================

% Spacing
\onehalfspacing

% Margins (SFU standard)
\geometry{
    left=1.25in,
    right=1in,
    top=1.25in,
    bottom=1.25in
}

% Bibliography style
\bibliographystyle{plainnat}

% Color setup
\definecolor{darkblue}{rgb}{0,0,0.5}
\definecolor{darkred}{rgb}{0.5,0,0}
\definecolor{darkgreen}{rgb}{0,0.5,0}

% Hyperlink colors
\hypersetup{
    colorlinks=true,
    citecolor=darkblue,
    linkcolor=darkblue,
    urlcolor=darkblue,
    bookmarks=true,
    bookmarksnumbered=true
}

% Code listing style
\lstset{
    basicstyle=\ttfamily\small,
    breaklines=true,
    commentstyle=\color{darkgreen},
    keywordstyle=\color{darkblue},
    stringstyle=\color{darkred},
    showstringspaces=false,
    columns=flexible,
    numbers=left,
    numberstyle=\tiny,
    frame=tb
}

% ======================================================================
% METADATA AND TITLE PAGE - CORRECTED
% ======================================================================

\begin{document}

\title{CRISPRO-MAMBA-X: Deep Learning Framework for CRISPR-Cas9 On-Target Efficacy Prediction -- A Multi-Modal Approach Integrating Sequence and Epigenomic Features}

\author{Amirhossein Daneshpajouh}

\previousdegrees{%
    B.Sc., Islamic Azad University, 2020}

\keywords{CRISPR-Cas9; On-Target Prediction; Epigenomic Features; Deep Learning; Transfer Learning; Conformal Prediction; Uncertainty Quantification}

% SFU REQUIRED FIELDS
\thesistype{Dissertation}
\degree{Doctor of Philosophy}
\department{School of Computing Science}
\faculty{Faculty of Applied Sciences}
\semester{Fall 2025}
\date{February 28, 2026}
\copyrightyear{2026}

% Committee members
% Manual committee page overrides these now
% Manual committee page overrides these now
% \seniorSupervisor{Dr. Kay C. Wiese}{Professor, School of Computing Science}
% \committee{Dr. Maxwell W. Libbrecht}{Associate Professor, School of Computing Science}
% \chair{To Be Announced}{School of Computing Science}

% ======================================================================
% BEGIN DOCUMENT
% ======================================================================

% ====================================================================
% ROBUST MANUAL FRONTMATTER (SFU STANDARD LAYOUT)
% ====================================================================

% --- TITLE PAGE ---
\thispagestyle{empty}
% --- COMPACT TITLE PAGE (FITS ON ONE PAGE) ---
\thispagestyle{empty}
\begin{center}
    \vspace*{0.5cm}

    {\Large\bfseries CRISPRO-MAMBA-X: A Bayesian Information-Theoretic State-Space Model with Mechanistic Interpretability for CRISPR Guide RNA Prediction \par}

    \vspace{1.5cm} % Reduced from 2.5cm

    by \par

    \vspace{0.8cm} % Reduced from 1cm

    {\large\bfseries Amirhossein Daneshpajouh \par}

    \vspace{0.8cm} % Reduced from 1cm

    B.Sc., Islamic Azad University, 2020 \par

    \vspace{2cm} % Reduced from 3cm

    Dissertation Submitted in Partial Fulfillment of the \par
    Requirements for the Degree of \par
    Doctor of Philosophy \par

    \vspace{0.8cm} % Reduced from 1cm

    in the \par

    \vspace{0.5cm}

    School of Computing Science \par
    Faculty of Applied Sciences \par

    \vfill

    \copyright\ Amirhossein Daneshpajouh 2026 \par
    SIMON FRASER UNIVERSITY \par
    February 2026
\end{center}
\clearpage
\pagenumbering{roman}
\setcounter{page}{2}

% --- APPROVAL PAGE ---
\chapter*{Approval}
\addcontentsline{toc}{chapter}{Approval}

\noindent
\begin{tabular}{@{}ll}
    \textbf{Name:} & Amirhossein Daneshpajouh \\[2ex]
    \textbf{Degree:} & Doctor of Philosophy \\[2ex]
    \textbf{Title:} & \parbox[t]{0.8\textwidth}{CRISPRO-MAMBA-X: A Bayesian Information-Theoretic State-Space Model with Mechanistic Interpretability for CRISPR Guide RNA Prediction} \\[4ex]
    \textbf{Examining Committee:} & \textbf{Chair:} To Be Announced \\
    & School of Computing Science \\[3ex]
    & \textbf{Dr. Kay C. Wiese} \\
    & Senior Supervisor \\
    & Professor \\
    & School of Computing Science \\[3ex]
    & \textbf{Dr. Maxwell W. Libbrecht} \\
    & Committee Member \\
    & Associate Professor \\
    & School of Computing Science \\[4ex]
    \textbf{Date Defended:} & February 28, 2026
\end{tabular}
\clearpage

% ======================================================================
% FRONTMATTER
% ======================================================================

\frontmatter

% ======================================================================
% ======================================================================
% ABSTRACT & KEYWORDS (Combined on same page)
% ======================================================================

\begin{abstract}
\small % Slightly reduce font size to ensure fit
\setlength{\parskip}{0.5em} % Tighten paragraph spacing
CRISPR-Cas9 has revolutionized genomic engineering, offering unprecedented potential for treating genetic diseases. However, its clinical translation is hindered by off-target effects and variable on-target efficiency. Comprehensive and accurate prediction of CRISPR-Cas9 outcomes remains a challenge due to the complex interplay between guide RNA sequences, local chromatin environment, and high-order genomic structure.

In this research, we introduce CRISPRO-MAMBA-X, a novel multi-modal deep learning framework that integrates extensive sequence context with high-dimensional epigenomic features to predict on-target editing efficacy and off-target risks with high precision. Unlike existing models that rely primarily on short sequence motifs, CRISPRO-MAMBA-X leverages a state-space model (Mamba) architecture to efficiently process long-range genomic sequences, capturing distal regulatory interactions. We further incorporate chromatin accessibility (ATAC-seq), histone modifications (ChIP-seq), and DNA methylation data, utilizing a cross-attention mechanism to fuse these heterogeneous modalities dynamically.

Benchmarking against state-of-the-art predictors on large-scale datasets (e.g., DeepHF, CRISPOR), CRISPRO-MAMBA-X demonstrates superior performance, particularly in hard-to-predict genomic regions. Furthermore, we implement conformal prediction to provide rigorous uncertainty quantification, delivering statistically valid confidence intervals for each predictionâ€”a critical feature for safety-critical clinical applications. Our framework not only improves guide selection accuracy but also offers interpretability, revealing key biological determinants of CRISPR efficacy. This work establishes a robust computational foundation for safe and effective therapeutic genome editing, effectively bridging the gap between computational prediction and clinical application.
\vspace{-0.5em} % Pull keywords up
\end{abstract}

\clearpage

% ======================================================================
% DEDICATION & ACKNOWLEDGMENTS (Combined on single page)
% ======================================================================

\phantomsection
\addcontentsline{toc}{chapter}{Dedication}
\begin{center}
{\Large\bfseries Dedication}
\end{center}
\vspace{1em}
\begin{center}
To my family, for their unwavering love and support.
\end{center}

\vspace{3em}

\phantomsection
\addcontentsline{toc}{chapter}{Acknowledgments}
\begin{center}
{\Large\bfseries Acknowledgments}
\end{center}
\vspace{1em}
I would like to express my deepest gratitude to my senior supervisor, Dr. Kay C. Wiese, for his invaluable guidance, support, and mentorship throughout this research. His insights and encouragement have been instrumental in shaping this dissertation.

I am also grateful to my committee member, Dr. Maxwell W. Libbrecht, for his constructive feedback and expertise, which significantly improved the quality of this work.

I extend my thanks to the School of Computing Science at Simon Fraser University for providing a stimulating research environment. Finally, I thank my colleagues and friends in the lab for the fruitful discussions and collaboration.

\clearpage


% ======================================================================
% TABLE OF CONTENTS, LISTS
% ======================================================================

\tableofcontents
\clearpage

\listoftables
\clearpage

\listoffigures
\clearpage

% ======================================================================
% MAIN MATTER
% ======================================================================

\mainmatter

% Include all chapters
\include{Chapter_1_Complete}
\include{Chapter_2_Complete}
\include{Chapter_3_Complete}
\include{Chapter_4_Complete}
\include{Chapter_5_Complete}
\include{Chapter_6_Complete}
\include{Chapter_7_Complete}
\include{Chapter_8_Complete}
\include{Chapter_9_Complete}
\include{Chapter_10_Complete}
\include{Chapter_11_Complete}
\include{Chapter_12_Complete}

% ======================================================================
% BIBLIOGRAPHY
% ======================================================================

\bibliography{complete_bibliography}

% ======================================================================
% APPENDICES (Optional)
% ======================================================================

\appendix

\chapter{Supplementary Materials}

\section{Supplementary Table 1: Detailed Dataset Statistics}

\begin{table}[H]
\centering
\caption{DeepHF dataset composition and characteristics}
\label{tab:deephf_supplementary}
\begin{tabular}{|l|c|}
\hline
\textbf{Property} & \textbf{Value} \\
\hline
Total guides & 59,898 \\
\hline
Unique genes & 19,952 \\
\hline
Median efficiency & 0.58 \\
\hline
Efficiency range & 0.001-0.99 \\
\hline
Training set & 40,000 \\
\hline
Validation set & 9,898 \\
\hline
Test set (held-out) & 10,000 \\
\hline
\end{tabular}
\end{table}

\section{Computational Environment}

\subsection{Software Versions}
\begin{itemize}
    \item Python 3.10.0
    \item PyTorch 2.1.0
    \item CUDA 12.1
    \item scikit-learn 1.3.0
    \item NumPy 1.24.0
    \item Pandas 2.0.0
\end{itemize}

\subsection{Hardware Specifications}
\begin{itemize}
    \item GPU: NVIDIA A100 (80 GB memory)
    \item CPU: Intel Xeon Platinum 8480 (56 cores)
    \item RAM: 512 GB
    \item Storage: 10 TB SSD
\end{itemize}

\subsection{Code Availability}

All code is available at: \url{https://github.com/your-username/crispro-mamba-x}

Trained models are available at: \url{https://huggingface.co/your-username/crispro-mamba-x}

% ======================================================================
% END DOCUMENT
% ======================================================================

\end{document}
