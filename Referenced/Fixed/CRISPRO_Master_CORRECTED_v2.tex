% ======================================================================
% MASTER THESIS DOCUMENT - FULLY CORRECTED VERSION
% CRISPRO-MAMBA-X: Revolutionary AI/ML Gene Editing Platform
% Simon Fraser University PhD Dissertation
% ======================================================================

\documentclass[12pt]{sfuthesis}

% ======================================================================
% ENCODING AND UNICODE SUPPORT (MUST BE FIRST)
% ======================================================================

\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage{newunicodechar}

% ======================================================================
% UNICODE CHARACTER DEFINITIONS - FIX FOR BOX DRAWING AND SYMBOLS
% ======================================================================

% Box drawing characters
\newunicodechar{│}{|}
\newunicodechar{├}{+}
\newunicodechar{─}{-}
\newunicodechar{└}{+}
\newunicodechar{┌}{+}
\newunicodechar{┐}{+}
\newunicodechar{┘}{+}
\newunicodechar{┬}{+}
\newunicodechar{┴}{+}
\newunicodechar{├}{+}
\newunicodechar{┤}{|}

% Mathematical symbols
\newunicodechar{≤}{\ensuremath{\leq}}
\newunicodechar{≥}{\ensuremath{\geq}}
\newunicodechar{→}{\ensuremath{\rightarrow}}
\newunicodechar{←}{\ensuremath{\leftarrow}}
\newunicodechar{±}{\ensuremath{\pm}}
\newunicodechar{×}{\ensuremath{\times}}
\newunicodechar{÷}{\ensuremath{\div}}
\newunicodechar{∈}{\ensuremath{\in}}
\newunicodechar{∉}{\ensuremath{\notin}}
\newunicodechar{∀}{\ensuremath{\forall}}
\newunicodechar{∃}{\ensuremath{\exists}}
\newunicodechar{∅}{\ensuremath{\emptyset}}
\newunicodechar{∆}{\ensuremath{\Delta}}
\newunicodechar{∑}{\ensuremath{\sum}}
\newunicodechar{∏}{\ensuremath{\prod}}
\newunicodechar{∫}{\ensuremath{\int}}
\newunicodechar{√}{\textasciitilde}
\newunicodechar{∞}{\ensuremath{\infty}}
\newunicodechar{≠}{\ensuremath{\neq}}
\newunicodechar{≈}{\ensuremath{\approx}}

% ======================================================================
% MATH PACKAGES
% ======================================================================

\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{amsfonts}
\usepackage{amsthm}
\usepackage{mathbbol}
\usepackage{mathtools}
\usepackage{xfrac}

% ======================================================================
% GRAPHICS AND FIGURES
% ======================================================================

\usepackage{xcolor}
\usepackage{graphicx}
\usepackage{float}
\usepackage{tikz}
\usepackage{pgfplots}
\usepackage{caption}
\usepackage{subcaption}

% ======================================================================
% TABLES
% ======================================================================

\usepackage{multirow}
\usepackage{array}
\usepackage{booktabs}
\usepackage{threeparttable}
\usepackage{longtable}
\usepackage{tabu}

% ======================================================================
% ALGORITHMS AND CODE
% ======================================================================

\usepackage{algorithm}
\usepackage{algpseudocode}
\usepackage{algorithmicx}
\usepackage{listings}

% ======================================================================
% BIBLIOGRAPHY AND REFERENCES
% ======================================================================

\usepackage{natbib}
\usepackage{hyperref}
\usepackage{url}

% ======================================================================
% FORMATTING
% ======================================================================

\usepackage{geometry}
\usepackage{setspace}
\usepackage{tocbibind}
\usepackage{fancyhdr}
\usepackage{lastpage}
\usepackage{lineno}
\usepackage{pifont}

% ======================================================================
% THEOREM ENVIRONMENTS
% ======================================================================

\theoremstyle{definition}
\newtheorem{definition}{Definition}[chapter]
\newtheorem{theorem}{Theorem}[chapter]
\newtheorem{lemma}{Lemma}[chapter]
\newtheorem{proposition}{Proposition}[chapter]
\newtheorem{corollary}{Corollary}[chapter]

\theoremstyle{remark}
\newtheorem{example}{Example}[chapter]
\newtheorem{remark}{Remark}[chapter]

% ======================================================================
% DOCUMENT SETUP
% ======================================================================

\onehalfspacing

\geometry{
    left=1.25in,
    right=1in,
    top=1.25in,
    bottom=1.25in
}

\bibliographystyle{plainnat}

\definecolor{darkblue}{rgb}{0,0,0.5}
\definecolor{darkred}{rgb}{0.5,0,0}
\definecolor{darkgreen}{rgb}{0,0.5,0}

\hypersetup{
    colorlinks=true,
    citecolor=darkblue,
    linkcolor=darkblue,
    urlcolor=darkblue,
    bookmarks=true,
    bookmarksnumbered=true
}

% Configure listings for UTF-8 support
\lstset{
    basicstyle=\ttfamily\small,
    breaklines=true,
    commentstyle=\color{darkgreen},
    keywordstyle=\color{darkblue},
    stringstyle=\color{darkred},
    showstringspaces=false,
    columns=flexible,
    numbers=left,
    numberstyle=\tiny,
    frame=tb,
    inputencoding=utf8,
    extendedchars=true
}

% Fix pgfplots compatibility warning
\pgfplotsset{compat=1.18}

% ======================================================================
% METADATA - SFU COMPLIANT
% ======================================================================

\title{CRISPRO-MAMBA-X: A Revolutionary Gene Editing Platform Combining Epigenomic Integration, Mamba State Space Models, and Conformal Prediction for Clinical CRISPR Therapeutics}

\author{Amirhossein Daneshpajouh}

\previousdegrees{B.Sc., Islamic Azad University, 2020}

\degree{Doctor of Philosophy}

% FIXED: Changed from \discipline to \thesistype
\thesistype{Dissertation}

\department{School of Computing Science}

\faculty{Faculty of Applied Science}

\copyrightyear{2026}

\semester{Spring 2026}

% ======================================================================
% KEYWORDS (SFU Required)
% ======================================================================

\keywords{CRISPR-Cas9; On-Target Prediction; Epigenomic Features; Deep Learning; Transfer Learning; Conformal Prediction; Uncertainty Quantification; Gene Editing; Machine Learning; Precision Medicine}

% ======================================================================
% BEGIN DOCUMENT
% ======================================================================

\begin{document}

% Generate title page automatically
\maketitle

% ======================================================================
% FRONTMATTER
% ======================================================================

\frontmatter

% ======================================================================
% ABSTRACT
% ======================================================================

\chapter*{Abstract}
\addcontentsline{toc}{chapter}{Abstract}

CRISPR-Cas9 has revolutionized genetic medicine but suffers from two critical limitations preventing clinical deployment: (1) inaccurate prediction of on-target cutting efficiency across diverse cell types and genomic contexts, and (2) inability to assess off-target cutting risk with clinical confidence. Current computational methods (DeepHF, CRISPRnet, AttCRISPR) operate on restricted genomic windows ($\pm$ 200 bp) and lack uncertainty quantification, making them insufficient for therapeutic guide selection.

This dissertation presents CRISPRO-MAMBA-X, a revolutionary AI/ML system that addresses these limitations through five coordinated innovations:

\begin{enumerate}
    \item \textbf{Comprehensive Epigenomics Integration:} Integrates 5 epigenomic modalities (ATAC accessibility, H3K27ac marks, 3D chromatin structure via Hi-C, nucleosome positioning, DNA methylation) with sequence information, achieving 8-12\% accuracy improvement over sequence-only baselines.
    
    \item \textbf{Long-Context Processing:} Mamba state space architecture processes 1.2 Mbp genomic context (12,000× larger than standard) with linear-time complexity \(O(N \cdot d)\), capturing TAD-scale chromatin features absent from prior models.
    
    \item \textbf{Off-Target Prediction:} Integrated framework predicting off-target cutting probability by combining guide-target matching with chromatin accessibility at off-target sites and 3D contact constraints, achieving AUC 0.88.
    
    \item \textbf{Uncertainty Quantification:} Conformal prediction provides mathematically-guaranteed 90\% coverage (distribution-free, model-free) with calibrated confidence intervals, meeting FDA regulatory requirements for clinical decision support.
    
    \item \textbf{Rigorous Validation:} Experimental validation through GUIDE-seq (Spearman 0.91 with on-target predictions), VIVO zebrafish model (AUC 0.87 off-target), and cross-dataset generalization (0.93 Spearman on independent datasets).
\end{enumerate}

\textbf{Key Results:}
\begin{itemize}
    \item On-target prediction: Spearman 0.970 (36\% improvement over CRISPRnet baseline 0.71)
    \item Off-target prediction: AUC 0.88 (17\% improvement over prior methods)
    \item Conformal calibration: 90.0\% empirical coverage (target 90\%), ECE = 0.004
    \item Computational efficiency: 0.92 seconds per sample on single GPU
    \item Cross-cell-type generalization: 2-4\% performance drop on similar cell types, 10\% on distant types
    \item Domain shift prediction: MMD-based framework with R\textsuperscript{2} = 0.91
\end{itemize}

\textbf{Clinical Impact:} CRISPRO-MAMBA-X enables FDA-clearable clinical deployment for CRISPR therapeutics. Long-term vision: treat 10M+ patients with genetic diseases globally over next decade.

% ======================================================================
% DEDICATION (Optional)
% ======================================================================

\chapter*{Dedication}
\addcontentsline{toc}{chapter}{Dedication}

To everyone suffering from genetic diseases, and to the researchers worldwide working to cure them.

% ======================================================================
% ACKNOWLEDGMENTS (FIXED: Now using \chapter* instead of \begin{acknowledgments})
% ======================================================================

\chapter*{Acknowledgments}
\addcontentsline{toc}{chapter}{Acknowledgments}

I gratefully acknowledge the contributions of my PhD committee, collaborators, and funding agencies.

This research was enabled by:
\begin{enumerate}
    \item The DeepHF dataset (59,898 guides) from Kim et al. (2019)
    \item GUIDE-seq experimental validation data from Tsai et al. (2015)
    \item VIVO in vivo validation framework
    \item Roadmap Epigenomics Consortium data (111 epigenomes)
    \item ENCODE project ATAC/H3K27ac reference data
    \item Computational resources from Simon Fraser University Research Computing
    \item My supervisors and committee members for their guidance and support
\end{enumerate}

Special thanks to Dr. Kay C. Wiese and Dr. Maxwell W. Libbrecht for their mentorship throughout this research journey.

% ======================================================================
% TABLE OF CONTENTS, LISTS
% ======================================================================

\tableofcontents
\clearpage

\listoftables
\clearpage

\listoffigures
\clearpage

% ======================================================================
% MAIN MATTER
% ======================================================================

\mainmatter

% Include all chapters - using \include for better handling
\include{Chapter_1_Complete}
\include{Chapter_2_Complete}
\include{Chapter_3_Complete}
\include{Chapter_4_Complete}
\include{Chapter_5_Complete}
\include{Chapter_6_Complete}
\include{Chapter_7_Complete}
\include{Chapter_8_Complete}
\include{Chapter_9_Complete}
\include{Chapter_10_Complete}
\include{Chapter_11_Complete}
\include{Chapter_12_Complete}

% ======================================================================
% BIBLIOGRAPHY
% ======================================================================

\bibliography{complete_bibliography}

% ======================================================================
% APPENDICES
% ======================================================================

\appendix

\chapter{Supplementary Materials}

\section{Supplementary Table 1: Detailed Dataset Statistics}

\begin{table}[H]
\centering
\caption{DeepHF dataset composition and characteristics}
\label{tab:deephf_supplementary}
\begin{tabular}{|l|c|}
\hline
\textbf{Property} & \textbf{Value} \\
\hline
Total guides & 59,898 \\
\hline
Unique genes & 19,952 \\
\hline
Median efficiency & 0.58 \\
\hline
Efficiency range & 0.001-0.99 \\
\hline
Training set & 40,000 \\
\hline
Validation set & 9,898 \\
\hline
Test set (held-out) & 10,000 \\
\hline
\end{tabular}
\end{table}

\section{Supplementary Table 2: Hyperparameter Search Space}

\begin{table}[H]
\centering
\caption{Neural Architecture Search hyperparameters}
\label{tab:nas_hyperparams}
\begin{tabular}{|l|c|c|}
\hline
\textbf{Parameter} & \textbf{Range} & \textbf{Best Value} \\
\hline
Learning rate & 1e-5 to 1e-2 & 5e-4 \\
\hline
Batch size & 32 to 512 & 128 \\
\hline
Dropout & 0.1 to 0.5 & 0.3 \\
\hline
Hidden dimension & 128 to 1024 & 512 \\
\hline
Mamba layers & 1 to 8 & 4 \\
\hline
Weight decay & 0 to 1e-3 & 5e-4 \\
\hline
\end{tabular}
\end{table}

\section{Computational Environment}

\subsection{Software Versions}
\begin{itemize}
    \item Python 3.10.0
    \item PyTorch 2.1.0
    \item CUDA 12.1
    \item scikit-learn 1.3.0
    \item NumPy 1.24.0
    \item Pandas 2.0.0
\end{itemize}

\subsection{Hardware Specifications}
\begin{itemize}
    \item GPU: NVIDIA A100 (80 GB memory)
    \item CPU: Intel Xeon Platinum 8480 (56 cores)
    \item RAM: 512 GB
    \item Storage: 10 TB SSD
\end{itemize}

\subsection{Code Availability}

All code and trained models are available upon request.

% ======================================================================
% END DOCUMENT
% ======================================================================

\end{document}
