% ======================================================================
% CHAPTER 7: CLINICAL UNCERTAINTY QUANTIFICATION (SHORT VERSION)
% ======================================================================

\chapter{Conformal Prediction for Clinical Risk Stratification}

FDA regulations for Software as a Medical Device (SaMD) require quantification of uncertainty. Point predictions ("Efficiency = 0.85") are insufficient. We implement \textbf{Conformal Prediction} to provide mathematically guaranteed confidence intervals.

\section{The Universal Coverage Guarantee}
Vovk et al.'s Universal Coverage Theorem guarantees that for any model and distribution, the prediction set $C(x)$ satisfies:
\begin{equation}
P(y \in C(x)) \geq 1 - \alpha
\end{equation}
For $\alpha=0.10$, we guarantee that \textbf{90\% of true efficiency values} will fall within our predicted interval range, regardless of biological noise or model architecture.

\begin{figure}[h!]
    \centering
    \fbox{\parbox{0.9\textwidth}{\centering \vspace{1cm} \textbf{FIGURE PLACEHOLDER} \\ \textbf{File:} figures/fig\_7\_1.png \\ \textbf{Description:} Conformal Coverage. The blue ribbon represents the 90\% guaranteed interval. Experimental data (blac... \vspace{1cm}}}
    \caption[Coverage]{Conformal Coverage. The blue ribbon represents the 90\% guaranteed interval. Experimental data (black dots) fall within this ribbon 90\% of the time, providing a safety buffer for clinical decisions.}
    \label{fig:conformal_short}
\end{figure}

\section{Mondrian Conformal Prediction}
CRISPR efficiency varies by cell type (e.g., T-cells vs. Stem Cells). A single global guarantee is insufficient (it might under-cover in difficult cell types).
We apply **Mondrian (Stratified) Conformal Prediction**, determining separate uncertainty thresholds ($q_{\alpha,c}$) for each cell type $c$.

\begin{equation}
\text{Interval}_c = [\hat{y} - q_{\alpha,c}, \hat{y} + q_{\alpha,c}]
\end{equation}

This ensures that safety guarantees hold \textbf{within each specific tissue type}, preventing a scenario where the model is "safe on average" but "dangerous in hepatocytes."

\section{Clinical Decision Support}
We output a composite \textbf{Quality Score} for guide ranking:
\begin{equation}
Q = \text{Efficiency}_{\text{lower\_bound}} - \lambda \cdot \text{OffTarget}_{\text{upper\_bound}}
\end{equation}
Clinicians select guides based on the \textit{conservative bounds} (worst-case scenario), ensuring patient safety even in the presence of biological uncertainty.
